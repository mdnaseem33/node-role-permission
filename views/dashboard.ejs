<!DOCTYPE html>
<html class="loading" lang="en" data-textdirection="ltr">
<!-- BEGIN: Head-->

<head>
    <base href="<%= req.protocol + '://' + req.get('host') %>" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui" />
    <meta name="description"
        content="MVS admin is super flexible, powerful, clean &amp; modern responsive bootstrap 4 admin panel with unlimited possibilities." />
    <meta name="keywords"
        content="admin panel, MVS admin panel, dashboard panel, flat admin panel, responsive admin panel, web app" />
    <meta name="author" content="MVS" />
    <title>Dashboard</title>
    <link rel="apple-touch-icon" href="app-assets/images/ico/apple-icon-120.png" />
    <link rel="shortcut icon" type="image/x-icon" href="app-assets/images/ico/favicon.ico" />

    <!-- BEGIN: Vendor CSS-->

    <link rel="stylesheet" type="text/css" href="app-assets/vendors/css/vendors.min.css" />
    <link rel="stylesheet" type="text/css" href="app-assets/vendors/css/tables/datatable/dataTables.bootstrap4.min.css">
    <link rel="stylesheet" type="text/css" href="app-assets/vendors/css/tables/datatable/responsive.bootstrap4.min.css">
    <link rel="stylesheet" type="text/css" href="app-assets/vendors/css/pickers/flatpickr/flatpickr.min.css">
    <link rel="stylesheet" type="text/css" href="app-assets/vendors/css/charts/apexcharts.css" />
    <link rel="stylesheet" type="text/css" href="app-assets/vendors/css/extensions/toastr.min.css" />
    <!-- END: Vendor CSS-->

    <!-- BEGIN: Theme CSS-->
    <link rel="stylesheet" type="text/css" href="app-assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="app-assets/css/bootstrap-extended.css" />
    <link rel="stylesheet" type="text/css" href="app-assets/css/colors.css" />
    <link rel="stylesheet" type="text/css" href="app-assets/css/components.css" />
    <link rel="stylesheet" type="text/css" href="app-assets/css/themes/dark-layout.css" />
    <link rel="stylesheet" type="text/css" href="app-assets/css/themes/bordered-layout.css" />

    <!-- BEGIN: Page CSS-->
    <link rel="stylesheet" type="text/css" href="app-assets/css/core/menu/menu-types/vertical-menu.css" />
    <link rel="stylesheet" type="text/css" href="app-assets/css/pages/dashboard-ecommerce.css" />
    <link rel="stylesheet" type="text/css" href="app-assets/css/plugins/charts/chart-apex.css" />
    <link rel="stylesheet" type="text/css" href="app-assets/css/plugins/extensions/ext-component-toastr.css" />
    <!-- END: Page CSS-->
    <% if(typeof css !== 'undefined'){ 
        css.forEach(function(s){ %>
        <link rel="stylesheet" type="text/css" href="<%= s %>"/>
      <% }); 
    }%>
    <!-- BEGIN: Custom CSS-->
    <link rel="stylesheet" type="text/css" href="assets/css/style.css" />
    <style>
        .select2-selection__arrow{
            display: none;
        }
    </style>
    <!-- END: Custom CSS-->
</head>
<!-- END: Head-->

<body class="vertical-layout vertical-menu-modern navbar-floating footer-static dark-layout" data-open="click"
    data-menu="vertical-menu-modern" data-col>
    <!-- BEGIN: Header-->
    <nav class="header-navbar navbar navbar-expand-lg align-items-center floating-nav navbar-light navbar-shadow">
        <div class="navbar-container d-flex content">
            
            <ul class="nav navbar-nav align-items-center ml-auto">
            
                    <li class="nav-item dropdown dropdown-user">
                        <a class="nav-link dropdown-toggle dropdown-user-link" id="dropdown-user"
                            href="javascript:void(0);" data-toggle="dropdown" aria-haspopup="true"
                            aria-expanded="false">
                            <div class="user-nav d-sm-flex d-none">
                                <span class="user-name font-weight-bolder">
                                    <%= req.session.user.name %>
                                </span>
                            </div>
                            <span class="avatar"><img class="round"
                                    src="app-assets/images/portrait/small/avatar-s-11.jpg" alt="avatar" height="40"
                                    width="40" /><span class="avatar-status-online"></span></span>
                        </a>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdown-user">
                            <button data-toggle="modal" data-target="#sync-api-modal"  style="width: 100%;" class="btn btn-flat-danger waves-effect dropdown-item">
                                <a href="javascript:void(0)" class="flat-danger">
                                    <i class="mr-50 flat-danger" data-feather="refresh-ccw"></i>  
                                </a> Sync
                            </button>
                            <button style="width: 100%;" class="btn btn-flat-danger waves-effect dropdown-item">
                                <a href="/process/restart" class="flat-danger">
                                    <i class="mr-50 flat-danger" data-feather="refresh-ccw"></i>  
                                    Restart
                                </a> 
                            </button>
                            <form action="/logout" method="post">
                                <button style="width: 100%;" class="btn btn-flat-danger waves-effect dropdown-item" type="submit">
                                    <a href="javascript:void(0)" class="flat-danger">
                                        <i class="mr-50 flat-danger" data-feather="power"></i>  
                                    </a> Logout
                                </button>
                               
                                
                            </form>
                            
                        </div>
                    </li>
            </ul>
        </div>
    </nav>
    
    <!-- END: Header-->

    <!-- BEGIN: Main Menu-->
    <div class="main-menu menu-fixed menu-light menu-accordion menu-shadow" data-scroll-to-active="true">
        <div class="navbar-header">
            <ul class="nav navbar-nav flex-row">
                <li class="nav-item mr-auto">
                    <a class="navbar-brand" href="<%= req.protocol + '://' + req.get('host') %>"><span class="brand-logo">
                        </span>
                        <h2 class="brand-text">404 Developer</h2>
                    </a>
                </li>
                <li class="nav-item nav-toggle">
                    <a class="nav-link modern-nav-toggle pr-0" data-toggle="collapse"><i
                            class="d-block d-xl-none text-primary toggle-icon font-medium-4" data-feather="x"></i><i
                            class="d-none d-xl-block collapse-toggle-icon font-medium-4 text-primary"
                            data-feather="disc" data-ticon="disc"></i></a>
                </li>
            </ul>
        </div>
        <div class="shadow-bottom"></div>
        <div class="main-menu-content">
            <ul class="navigation navigation-main" id="main-menu-navigation" data-menu="menu-navigation">
                
                <% if(menu){
                    menu.map(m => {
                        if(m.child){
                            %>
                            <li class="nav-item has-sub">
                                <a class="d-flex align-items-center" href="<%=m.url%>"><i data-feather="<%=m.icon%>"></i><span
                                        class="menu-title text-truncate"> <%= m.name %> </span></a>
                                <ul class="menu-content">
                                    <%
                                        m.child.map(child=> {
                                            %>
                                            <li class="nav-item">
                                                <a class="d-flex align-items-center" href="<%=child.url%>"><i data-feather="<%=child.icon%>"></i><span
                                                        class="menu-title text-truncate"> <%= child.name %> </span></a>
                                            </li>
                                            <%
                                        })
                                    %>
                                    
                                </ul>
                                

                            </li>
                            <%
                        }else{
                            %>
                             <li class="nav-item">
                                <a class="d-flex align-items-center" href="<%=m.url%>"><i data-feather="<%=m.icon%>"></i><span
                                        class="menu-title text-truncate"> <%= m.name %> </span></a>
                            </li>
                        <%
                        }
                    })
                } %>
               
                
            </ul>
        </div>
    </div>
    <!-- END: Main Menu-->

    <!-- BEGIN: Content-->
    <div class="app-content content">
        <div class="content-overlay"></div>
        <div class="header-navbar-shadow"></div>
        <div class="content-wrapper">
            <% if (error.length > 0) { 
                error.map(e =>{ %>
                    <div class="alert alert-danger" role="alert">
                        <div class="alert-body"><%= e %></div>
                    </div>
            <% })
            } %>
            <% if (info.length > 0) { 
                info.map(e =>{ %>
                    <div class="alert alert-info" role="alert">
                        <div class="alert-body"><%= e %></div>
                    </div>
            <% })
            } %>
            <% if (success.length > 0) { 
                success.map(e =>{ %>
                    <div class="alert alert-success" role="alert">
                        <div class="alert-body"><%= e %></div>
                    </div>
            <% })
            } %>
            <% if (warning.length > 0) { 
                warning.map(e =>{ %>
                    <div class="alert alert-warning" role="alert">
                        <div class="alert-body"><%= e %></div>
                    </div>
            <% })
            } %>
            <div class="content-body">
                <%- include(page, {data:data, req: req}); %>
            </div>
        </div>
    </div>
    <!-- END: Content-->
    <div class="modal fade text-left" id="sync-api-modal" tabindex="-1" aria-labelledby="myModalLabel1" aria-hidden="true" style="display: none;">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title" id="myModalLabel1">Sync ICCC Data</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div id="sync-form-app" class="content-body">
                        <div class="auth-wrapper auth-v1 px-2">
                            <div class="auth-inner py-2">
                                <!-- Login v1 -->
                                <div class="card mb-0">
                                    <div class="card-body">
        
                                        <h4 class="card-title mb-1">ICCC LOGIN</h4>
                                        <p class="card-text mb-2">Please sign-in to your account and start the sync</p>
        
                                        <div class="auth-login-form mt-2" action="/login" method="POST">
                                            <div class="form-group">
                                                <label for="login-email" class="form-label">Username</label>
                                                <input v-model="email" type="text" class="form-control" id="login-email" name="email"
                                                    placeholder="username" aria-describedby="login-email" tabindex="1"
                                                    autofocus />
                                            </div>
        
                                            <div class="form-group">
                                                <div class="input-group input-group-merge form-password-toggle">
                                                    <input type="password" class="form-control form-control-merge"
                                                        id="login-password" name="password" tabindex="2" v-model="password"
                                                        placeholder="&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;"
                                                        aria-describedby="login-password" />
                                                    <div class="input-group-append">
                                                        <span class="input-group-text cursor-pointer"><i
                                                                data-feather="eye"></i></span>
                                                    </div>
                                                </div>
                                            </div>

                                            <div v-if="message" class="alert alert-danger" role="alert">
                                                <div class="alert-body">
                                                    {{message}}
                                                </div>
                                            </div>
                                            <button @click="login" class="btn btn-primary btn-block" tabindex="4">Sync ICCC</button>
                                        </div>
        
        
                                    </div>
                                </div>
                                <!-- /Login v1 -->
                            </div>
                        </div>
        
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary waves-effect waves-float waves-light" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <div class="sidenav-overlay"></div>
    <div class="drag-target"></div>

    <!-- BEGIN: Footer-->
    <footer class="footer footer-static footer-light">
        <p class="clearfix mb-0">
            <span class="float-md-left d-block d-md-inline-block mt-25">COPYRIGHT
                &copy; 2020<a class="ml-25" href="https://MVS.martvalley.com/" target="_blank">MVS</a><span
                    class="d-none d-sm-inline-block">, All rights
                    Reserved</span></span><span class="float-md-right d-none d-md-block">Hand-crafted & Made
                with<i data-feather="heart"></i></span>
        </p>
    </footer>
    <button class="btn btn-primary btn-icon scroll-top" type="button">
        <i data-feather="arrow-up"></i>
    </button>
    <!-- END: Footer-->

    <!-- BEGIN: Vendor JS-->
    <script src="app-assets/vendors/js/vendors.min.js"></script>
    <!-- BEGIN Vendor JS-->

     <!-- BEGIN: Page Vendor JS-->
     <script src="../app-assets/vendors/js/tables/datatable/jquery.dataTables.min.js"></script>
     <script src="../app-assets/vendors/js/tables/datatable/datatables.bootstrap4.min.js"></script>
     <script src="../app-assets/vendors/js/tables/datatable/dataTables.responsive.min.js"></script>
     <script src="../app-assets/vendors/js/tables/datatable/responsive.bootstrap4.js"></script>
     <script src="../app-assets/vendors/js/pickers/flatpickr/flatpickr.min.js"></script>
     <!-- END: Page Vendor JS-->

    <!-- BEGIN: Page Vendor JS-->
    <script src="app-assets/vendors/js/charts/apexcharts.min.js"></script>
    <script src="app-assets/vendors/js/extensions/toastr.min.js"></script>
    <!-- END: Page Vendor JS-->

    <!-- BEGIN: Theme JS-->
    <script src="app-assets/js/core/app-menu.js"></script>
    <script src="app-assets/js/core/app.js"></script>
    <!-- END: Theme JS-->
 <!-- END: Theme JS-->
 <script src="app-assets/js/core/vue.js"></script>
 <script src="app-assets/js/core/axios.js"></script>
    <% script.forEach(function(s){ %>
        <script src="<%= s %>"></script>
      <% }); %>

    <!-- END: Page JS-->

    <script>
        $(window).on("load", function () {
            if (feather) {
                feather.replace({
                    width: 14,
                    height: 14,
                });
            }

            const { createApp } = Vue

            createApp({
                data() {
                    return {
                        email:"",
                        password:"",
                        message: '',
                    }
                },
                methods:{
                    login(){
                        let self= this;
                        if(self.email.length < 4 || self.password.length < 4){
                            self.message="enter valid username and password"
                            return ;
                        }
                        axios.post('/system-login-sync', { email: self.email, password: self.password }).then((res)=>{
                            if(res.data.status === true){
                                window.location= window.location.origin;
                            }else if(res.data.status === false){
                                self.message="Invali Username password";
                            }else{
                                self.message=res.data.status;
                            }
                        });
                    }
                }
            }).mount('#sync-form-app');

        });
        
    </script>

</body>
<!-- END: Body-->

</html>